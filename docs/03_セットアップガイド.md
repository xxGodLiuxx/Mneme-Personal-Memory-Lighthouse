# Mneme - Personal Memory Lighthouse セットアップガイド

## 必要な環境

- Windows 10/11
- Python 3.10以上
- Claude Desktop（インストール済み）
- Notion アカウント（既存のデータベースへのアクセス権）
- 管理者権限（シンボリックリンク作成用）

---

## セットアップ手順

### ステップ1: Python環境の準備

#### 1.1 Pythonのインストール確認
```cmd
python --version
```

Python 3.10以上がインストールされていない場合：
1. [Python公式サイト](https://www.python.org/)からダウンロード
2. インストール時に「Add Python to PATH」にチェック

#### 1.2 必要なパッケージのインストール
```cmd
pip install fastmcp
```

### ステップ2: プログラムファイルの配置

#### 2.1 ディレクトリ構造の作成
```cmd
mkdir C:\Users\%USERNAME%\Documents\PharosSystem_v2\Pharosophia_Ch2\JaH_ThoughtTrace
```

#### 2.2 MCPサーバーファイルの配置

以下のファイルを上記ディレクトリに配置：

**hybrid_memory_mcp.py** - メインのMCPサーバー
```python
#!/usr/bin/env python3
"""
ハイブリッドメモリMCPサーバー
ClaudeのネイティブNotion連携と連動して動作
"""
# ファイル内容は提供されたコードを使用
```

**simple_memory_mcp.py** - テスト用シンプル版
```python
#!/usr/bin/env python3
"""
シンプルメモリMCPサーバー
基本的なメモリ管理機能のみ
"""
# ファイル内容は提供されたコードを使用
```

### ステップ3: Claude Desktop設定

#### 3.1 設定ファイルの場所を開く
```cmd
explorer %APPDATA%\Claude
```

#### 3.2 claude_desktop_config.jsonを編集

以下の内容で作成または編集：

```json
{
  "mcpServers": {
    "jah-memory": {
      "command": "C:\\Users\\[あなたのユーザー名]\\AppData\\Local\\Programs\\Python\\Python310\\python.exe",
      "args": ["C:\\Users\\[あなたのユーザー名]\\Documents\\PharosSystem_v2\\Pharosophia_Ch2\\JaH_ThoughtTrace\\hybrid_memory_mcp.py"]
    },
    "simple-memory": {
      "command": "C:\\Users\\[あなたのユーザー名]\\AppData\\Local\\Programs\\Python\\Python310\\python.exe",
      "args": ["C:\\Users\\[あなたのユーザー名]\\Documents\\PharosSystem_v2\\Pharosophia_Ch2\\JaH_ThoughtTrace\\simple_memory_mcp.py"]
    }
  }
}
```

**重要**: `[あなたのユーザー名]`を実際のWindowsユーザー名に置換

#### 3.3 Pythonパスの確認
```cmd
where python
```
出力されたパスを設定ファイルの`command`に使用

### ステップ4: データディレクトリの初期化

```cmd
mkdir %USERPROFILE%\.jah_thoughttrace
```

### ステップ5: Claude Desktopの再起動

1. タスクトレイのClaudeアイコンを右クリック
2. 「終了」を選択
3. Claude Desktopを再起動
4. **新しいセッションを開始**（重要！）

### ステップ6: 動作確認

#### 6.1 基本動作テスト
新しいClaude Desktopセッションで：
```
「get_memory_stats を実行して」
```

#### 6.2 ツール確認
```
「利用可能なMCPツールを表示して」
```

以下が表示されれば成功：
- jah-memoryのツール群
- simple-memoryのツール群（テスト用）

## トラブルシューティング

### 問題: MCPツールが見つからない

#### 確認事項：
1. **Claude Desktop完全再起動**: タスクマネージャーで全プロセス終了確認
2. **新しいセッション**: 既存の会話ではなく新規会話で確認
3. **設定ファイルパス**: 絶対パスが正しいか確認

#### デバッグ手順：
```cmd
# Pythonパス確認
where python

# ファイル存在確認
dir C:\Users\%USERNAME%\Documents\PharosSystem_v2\Pharosophia_Ch2\JaH_ThoughtTrace\*.py

# 設定ファイル確認
type %APPDATA%\Claude\claude_desktop_config.json
```

### 問題: エンコーディングエラー

#### 解決方法：
1. すべての出力から絵文字を削除
2. ファイルエンコーディングをUTF-8に統一
3. Pythonファイルの先頭に追加：
```python
# -*- coding: utf-8 -*-
```

### 問題: 権限エラー

#### 解決方法：
1. 管理者権限でコマンドプロンプト起動
2. データディレクトリの権限確認：
```cmd
icacls %USERPROFILE%\.jah_thoughttrace
```

## 高度な設定

### カスタムデータ保存場所

デフォルト以外の場所を使用する場合：

1. MCPサーバーファイルを編集
2. `DATA_DIR`変数を変更：
```python
DATA_DIR = Path("D:/MyData/JaH_ThoughtTrace")
```

### 複数プロファイル対応

異なる用途で複数のメモリセットを管理：

```json
{
  "mcpServers": {
    "jah-memory-work": {
      "command": "python.exe",
      "args": ["hybrid_memory_mcp.py", "--profile", "work"]
    },
    "jah-memory-personal": {
      "command": "python.exe",
      "args": ["hybrid_memory_mcp.py", "--profile", "personal"]
    }
  }
}
```

### パフォーマンス最適化

大量のメモリを扱う場合：

1. **インデックスの定期的な再構築**
```python
python rebuild_index.py
```

2. **古いメモリのアーカイブ**
```python
python archive_old_memories.py --days 365
```

## セキュリティ考慮事項

### データ保護

1. **定期バックアップ**
```cmd
xcopy %USERPROFILE%\.jah_thoughttrace D:\Backup\JaH_%DATE:~0,4%%DATE:~5,2%%DATE:~8,2% /E /I
```

2. **暗号化オプション**
- BitLockerでドライブ暗号化
- または7-Zipでパスワード付きアーカイブ

### アクセス制限

1. **ファイル権限設定**
```cmd
icacls %USERPROFILE%\.jah_thoughttrace /inheritance:r /grant:r %USERNAME%:F
```

## アップデート手順

### MCPサーバーの更新

1. Claude Desktopを終了
2. 新しいファイルで上書き
3. Claude Desktop再起動
4. 新機能の確認

### データ移行

旧バージョンからの移行：
```python
python migrate_data.py --from v1 --to v2
```

## 完了チェックリスト

- [ ] Python 3.10以上インストール済み
- [ ] fastmcpインストール済み
- [ ] MCPサーバーファイル配置済み
- [ ] claude_desktop_config.json設定済み
- [ ] データディレクトリ作成済み
- [ ] Claude Desktop再起動済み
- [ ] MCPツール動作確認済み
- [ ] テストメモリ作成成功

すべてチェックできたら、セットアップ完了です！

---

## 次のステップ

1. [使用ガイド](02_使用ガイド.md)を読んで基本操作を習得
2. [同期マニュアル](04_同期マニュアル.md)で複数PC設定
3. 毎日の使用を開始

*セットアップに関する質問は、新しいClaude Desktopセッションで聞いてください。*